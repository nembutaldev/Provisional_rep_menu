{"ast":null,"code":"var _jsxFileName = \"/Users/Buffalo/Desktop/menu/copia/Provisional_rep_menu/src/pages/auth/menus/items/section.jsx\";\nimport React from 'react';\nimport { ContainerSection, TitleForm } from '../styles/menu-styles';\nimport Modal from '../../../../components/modales/modal';\nimport Item from './item';\nimport { ButtonAction } from '../../../../components/buttons/button-action';\nimport { PutMethod, PostMethod, DeleteMethod } from '../../../../utils/peticiones';\nimport { connect } from 'react-redux';\nimport FormItem from './forms/form-item';\nimport { ButtonIcon } from '../../../../components/buttons/button-icon';\nimport { SuccesAlert, ErrorAlert, InfoAlert } from '../../../../utils/alertas';\nimport { Input } from '../../../../components/inputs/inputs';\nimport { FieldInput, Label, Form } from '../../../../components/inputs/item-forms';\nimport { Split } from '../../../../components/containers/containers';\nimport BarCharge from '../../../../components/spiners/bar-charge';\nconst initialState = {\n  name: '',\n  price: '',\n  description: '',\n  image: null,\n  imageUrl: ''\n};\n\nconst Section = props => {\n  console.log('DEBUGGenado------------>', props);\n  const token = props.sesion.token;\n  const [togglemodal, setTogglemodal] = React.useState(false);\n  const [togglePut, setToggleput] = React.useState(false);\n\n  const showPut = () => setToggleput(!togglePut);\n\n  const [item, setItem] = React.useState(initialState);\n  const [products, setProducts] = React.useState([]);\n  const [name, setName] = React.useState(props.sect.name);\n  const [objects, setObjects] = React.useState([]);\n  const [deletemodal, setDeleteModal] = React.useState(false);\n  const [image, setImage] = React.useState({\n    image: null,\n    imageUrl: ''\n  });\n  const [up, setUp] = React.useState(false);\n  const [down, setDown] = React.useState(false);\n  const [send, setSend] = React.useState(false);\n\n  const showModal = () => setTogglemodal(!togglemodal);\n\n  React.useEffect(() => {\n    const render = props.objects.filter(obj => obj.section_id === props.sect.id_section);\n    setObjects(render);\n  }, [props]); // AÑADIR ITEMS A LAS SECCIONES\n\n  const addItem = async () => {\n    setSend(true);\n    const nameProduct = item.name;\n    const newProducts = products;\n    newProducts.push(nameProduct);\n    const index = newProducts.indexOf(nameProduct);\n\n    if (nameProduct === '' || item.price === '' || item.description === '' || image.image === null) {\n      InfoAlert('Llena todos los campos');\n      setSend(false);\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('name', nameProduct);\n    formData.append('price', item.price);\n    formData.append('description', item.description);\n    formData.append('id_section', props.sect.id_section);\n    formData.append('index', index);\n    formData.append('image', image.image); //console.log('ESTO SE ENVIA', image)\n\n    const result = await PostMethod(formData, `api/users/product`, {\n      Authoritazion: 'Bearer ' + token\n    });\n\n    if (result.ok) {\n      props.addProduct(result.response.data);\n      setItem(initialState);\n      setImage({\n        image: null,\n        imageUrl: ''\n      });\n      SuccesAlert('Producto creado');\n      setSend(false);\n    } else {\n      ErrorAlert('Algo salio mal');\n      console.log(result.response);\n      setSend(false);\n    }\n\n    showModal();\n  }; // AÑADIR ITEMS A LAS SECCIONES\n\n\n  const handleSection = e => {\n    setName(e.target.value);\n  };\n\n  const handleSubmit = async () => {\n    // const menuId  = props.sect.menu_id\n    const sectionId = props.sect.id_section;\n    const menuName = name;\n    const index = props.sect.index;\n    const putSection = {\n      name: menuName,\n      id_section: sectionId,\n      index: index\n    };\n    const mapear = props.sections.map(section => {\n      return section.id_section;\n    });\n    const element = mapear.indexOf(props.sect.id_section);\n    const result = await PutMethod(putSection, `api/users/section/${sectionId}`, {\n      Authoritazion: 'Bearer ' + token\n    });\n\n    if (result.ok) {\n      console.log(result.response.data.data);\n      props.sections.splice(element, 1, result.response.data.data);\n      props.cleanSections();\n      props.editSection(props.sections);\n      SuccesAlert('Seccion Actualizada');\n    } else {\n      ErrorAlert('Algo salio mal');\n    }\n  };\n\n  const deleteModal = () => setDeleteModal(!deletemodal);\n\n  const deleteSection = async () => {\n    const idSection = props.sect.id_section;\n    const secciones = props.sections.map(seccion => seccion.id_section);\n    const index = secciones.indexOf(idSection);\n    const arrSections = props.sections; //console.log('%c->RESULTADO-RESULTADO', 'color:peru', arrSections)\n\n    const result = await DeleteMethod(`api/users/section/${idSection}`);\n\n    if (result.ok) {\n      arrSections.splice(index, 1);\n      props.cleanSections();\n      props.dltSection(arrSections);\n      SuccesAlert('Esta sección ha sido eliminada');\n    } else {\n      ErrorAlert('Algo salio mal');\n    }\n  };\n\n  const cerrarFunction = () => setDeleteModal(false);\n\n  const upPosition = async () => {\n    setUp(true);\n    const secciones = props.sections;\n    const mapSecciones = secciones.map(section => section.id_section);\n    const seccion = props.sect.id_section;\n    const index = mapSecciones.indexOf(seccion);\n    const upMover = secciones[index - 1];\n    const mover = secciones[index];\n\n    if (index === 0) {\n      //console.log('Primer elemento')\n      const [first] = secciones.splice(index, 1);\n      secciones.push(first);\n      const newSections = {\n        id_menu: props.sect.menu_id,\n        sections: secciones\n      }; //TO DO:PETICION\n      //console.log('%c->PRMER ELEMENTO', 'color:tomato', newSections)\n\n      const result = await PostMethod(newSections, 'api/users/section/sort', {\n        Authorization: 'Bearer ' + token\n      }); //console.log('RESPUESTA TIGRE',result.response.data)\n\n      if (result.ok) {\n        props.cleanSections();\n        props.editSection(result.response.data);\n        setUp(false);\n      } else {\n        ErrorAlert('Algo salio mal');\n        setUp(false);\n      }\n\n      return;\n    }\n\n    secciones.splice(index, 1, upMover);\n    secciones[index - 1] = mover;\n    const newSections = {\n      id_menu: props.sect.menu_id,\n      sections: secciones\n    }; //TO DO: peticion\n    //console.log('%c->ELEMENTO DE ARRIBA', 'color:tomato', newSections)\n\n    const result = await PostMethod(newSections, 'api/users/section/sort', {\n      Authorization: 'Bearer ' + token\n    }); //console.log('RESPUESTA TIGRE',result.response.data)\n\n    if (result.ok) {\n      props.cleanSections();\n      props.editSection(result.response.data);\n      setUp(false);\n    } else {\n      setUp(false);\n      ErrorAlert('Algo salio mal');\n    }\n  };\n\n  const downPosition = async () => {\n    setDown(true);\n    const secciones = props.sections;\n    const mapSecciones = secciones.map(section => section.id_section);\n    const seccion = props.sect.id_section;\n    const index = mapSecciones.indexOf(seccion);\n    const downMover = secciones[index + 1];\n    const mover = secciones[index];\n\n    if (secciones.length - 1 === index) {\n      const [last] = secciones.splice(index, 1);\n      secciones.unshift(last);\n      const newSections = {\n        id_menu: props.sect.menu_id,\n        sections: secciones\n      };\n      const result = await PostMethod(newSections, 'api/users/section/sort', {\n        Authorization: 'Bearer ' + token\n      });\n      console.log(result.response.data);\n\n      if (result.ok) {\n        props.cleanSections();\n        props.editSection(result.response.data);\n        setDown(false);\n      } else {\n        ErrorAlert('Algo salio mal');\n        setDown(false);\n      } //console.log('%c->DOWN', 'color:tomato', newSections)\n\n\n      return;\n    }\n\n    secciones.splice(index, 1, downMover);\n    secciones[index + 1] = mover;\n    const newSections = {\n      id_menu: props.sect.menu_id,\n      sections: secciones\n    };\n    const result = await PostMethod(newSections, 'api/users/section/sort', {\n      Authorization: 'Bearer ' + token\n    });\n    console.log('RESPUESTA TIGRE', result.response.data);\n\n    if (result.ok) {\n      props.cleanSections();\n      props.editSection(result.response.data);\n      setDown(false);\n    } else {\n      ErrorAlert('Algo salio mal');\n      setDown(false);\n    } //console.log('%c->DOWN', 'color:tomato', newSections)\n\n  };\n\n  return /*#__PURE__*/React.createElement(ContainerSection, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Modal, {\n    toggle: togglemodal,\n    toggleModal: showModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FormItem, Object.assign({\n    item: item,\n    setItem: setItem,\n    addItem: addItem,\n    image: image,\n    setImage: setImage\n  }, props, {\n    send: send,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(Modal, {\n    toggle: togglePut,\n    toggleModal: showPut,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    style: {\n      color: 'var(--colordos)',\n      fontSize: '1.5rem',\n      fontFamily: 'Bold',\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 29\n    }\n  }, \"Editar secci\\xF3n\")), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 29\n    }\n  }, \"Editar nombre de secci\\xF3n\"), /*#__PURE__*/React.createElement(Input, {\n    name: \"name\",\n    onChange: handleSection,\n    value: name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ButtonAction, {\n    onClick: e => {\n      e.preventDefault();\n      handleSubmit();\n    },\n    maxWidth: \"100%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 29\n    }\n  }, \"Editar\")))), /*#__PURE__*/React.createElement(Modal, {\n    toggle: deletemodal,\n    toggleModal: deleteModal,\n    cerrarFunction: cerrarFunction,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TitleForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 25\n    }\n  }, \"\\xBFDesas borrar esta secci\\xF3n?\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 25\n    }\n  }, \"Al eliminar esta seccion se eliminar\\xE1n todos los items que contenga.\")), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"section\", {\n    style: {\n      width: '100%',\n      maxWidth: '220px',\n      margin: 'auto'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Split, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(ButtonAction, {\n    onClick: deleteSection,\n    maxWidth: \"100px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 29\n    }\n  }, \"Si\"), /*#__PURE__*/React.createElement(ButtonAction, {\n    onClick: deleteModal,\n    maxWidth: \"100px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 29\n    }\n  }, \"Cancelar\"))))), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"header\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      color: 'var(--colordos)'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-columns\",\n    style: {\n      marginRight: '5px',\n      color: 'var(--colordos)'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 21\n    }\n  }), name), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(ButtonIcon, {\n    fontSize: \"1rem\",\n    backColor: \"var(--colorcuatro)\",\n    onClick: showPut,\n    color: \"var(--colordos)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-edit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 34\n    }\n  })), /*#__PURE__*/React.createElement(ButtonIcon, {\n    fontSize: \"1rem\",\n    backColor: \"var(--colorcuatro)\",\n    onClick: deleteModal,\n    color: \"var(--colordos)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-trash-alt\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 34\n    }\n  })), up ? /*#__PURE__*/React.createElement(BarCharge, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(ButtonIcon, {\n    fontSize: \"1rem\",\n    backColor: \"var(--colorcuatro)\",\n    onClick: upPosition,\n    color: \"var(--colordos)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-chevron-circle-up\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 38\n    }\n  })), down ? /*#__PURE__*/React.createElement(BarCharge, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 25\n    }\n  }) : /*#__PURE__*/React.createElement(ButtonIcon, {\n    fontSize: \"1rem\",\n    backColor: \"var(--colorcuatro)\",\n    onClick: downPosition,\n    color: \"var(--colordos)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-chevron-circle-down\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 38\n    }\n  })))), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 13\n    }\n  }, props.objects.length === 0 ? null : /*#__PURE__*/React.createElement(React.Fragment, null, objects.map((obj, i) => {\n    return /*#__PURE__*/React.createElement(Item, {\n      key: i,\n      obj: obj,\n      item: item,\n      setItem: setItem,\n      addItem: addItem,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 36\n      }\n    });\n  }))), /*#__PURE__*/React.createElement(\"section\", {\n    className: \"btn-add\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ButtonAction, {\n    onClick: showModal,\n    icon: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 17\n    }\n  }, \"A\\xF1adir productos\", /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-plus-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 21\n    }\n  }))));\n}; //REDUX---------->\n\n\nconst mapStateToProps = state => {\n  return {\n    sesion: state.login,\n    sections: state.menuSection,\n    objects: state.menuObject\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    editSection: data => {\n      dispatch({\n        type: 'EDITAR_SECTION',\n        data: data\n      });\n    },\n    cleanSections: () => {\n      dispatch({\n        type: 'CLEAN_SECTIONS'\n      });\n    },\n    addProduct: data => {\n      dispatch({\n        type: 'ADD_OBJECT',\n        data: data\n      });\n    },\n    dltSection: data => {\n      dispatch({\n        type: 'EDITAR_SECTION',\n        data: data\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Section);","map":{"version":3,"sources":["/Users/Buffalo/Desktop/menu/copia/Provisional_rep_menu/src/pages/auth/menus/items/section.jsx"],"names":["React","ContainerSection","TitleForm","Modal","Item","ButtonAction","PutMethod","PostMethod","DeleteMethod","connect","FormItem","ButtonIcon","SuccesAlert","ErrorAlert","InfoAlert","Input","FieldInput","Label","Form","Split","BarCharge","initialState","name","price","description","image","imageUrl","Section","props","console","log","token","sesion","togglemodal","setTogglemodal","useState","togglePut","setToggleput","showPut","item","setItem","products","setProducts","setName","sect","objects","setObjects","deletemodal","setDeleteModal","setImage","up","setUp","down","setDown","send","setSend","showModal","useEffect","render","filter","obj","section_id","id_section","addItem","nameProduct","newProducts","push","index","indexOf","formData","FormData","append","result","Authoritazion","ok","addProduct","response","data","handleSection","e","target","value","handleSubmit","sectionId","menuName","putSection","mapear","sections","map","section","element","splice","cleanSections","editSection","deleteModal","deleteSection","idSection","secciones","seccion","arrSections","dltSection","cerrarFunction","upPosition","mapSecciones","upMover","mover","first","newSections","id_menu","menu_id","Authorization","downPosition","downMover","length","last","unshift","color","fontSize","fontFamily","textAlign","preventDefault","width","maxWidth","margin","marginRight","display","i","mapStateToProps","state","login","menuSection","menuObject","mapDispatchToProps","dispatch","type"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,gBAAT,EAA2BC,SAA3B,QAA4C,uBAA5C;AACA,OAAOC,KAAP,MAAkB,sCAAlB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,SAASC,YAAT,QAA6B,8CAA7B;AACA,SAASC,SAAT,EAAoBC,UAApB,EAAgCC,YAAhC,QAAoD,8BAApD;AACA,SAAQC,OAAR,QAAsB,aAAtB;AACA,OAAOC,QAAP,MAAqB,mBAArB;AACA,SAASC,UAAT,QAA2B,4CAA3B;AACA,SAASC,WAAT,EAAsBC,UAAtB,EAAkCC,SAAlC,QAAmD,2BAAnD;AACA,SAASC,KAAT,QAAsB,sCAAtB;AACA,SAASC,UAAT,EAAqBC,KAArB,EAA4BC,IAA5B,QAAwC,0CAAxC;AACA,SAASC,KAAT,QAAsB,8CAAtB;AACA,OAAOC,SAAP,MAAsB,2CAAtB;AAEA,MAAMC,YAAY,GAAC;AACfC,EAAAA,IAAI,EAAC,EADU;AAEfC,EAAAA,KAAK,EAAC,EAFS;AAGfC,EAAAA,WAAW,EAAC,EAHG;AAIfC,EAAAA,KAAK,EAAC,IAJS;AAKfC,EAAAA,QAAQ,EAAC;AALM,CAAnB;;AAQA,MAAMC,OAAO,GAAIC,KAAD,IAAW;AACvBC,EAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ,EAAwCF,KAAxC;AACA,QAAMG,KAAK,GAAGH,KAAK,CAACI,MAAN,CAAaD,KAA3B;AACA,QAAM,CAACE,WAAD,EAAcC,cAAd,IAAgClC,KAAK,CAACmC,QAAN,CAAe,KAAf,CAAtC;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BrC,KAAK,CAACmC,QAAN,CAAe,KAAf,CAAlC;;AACA,QAAMG,OAAO,GAAG,MAAMD,YAAY,CAAC,CAACD,SAAF,CAAlC;;AACA,QAAM,CAACG,IAAD,EAAOC,OAAP,IAAkBxC,KAAK,CAACmC,QAAN,CAAed,YAAf,CAAxB;AACA,QAAM,CAACoB,QAAD,EAAWC,WAAX,IAA0B1C,KAAK,CAACmC,QAAN,CAAe,EAAf,CAAhC;AACA,QAAM,CAACb,IAAD,EAAOqB,OAAP,IAAiB3C,KAAK,CAACmC,QAAN,CAAeP,KAAK,CAACgB,IAAN,CAAWtB,IAA1B,CAAvB;AACA,QAAM,CAACuB,OAAD,EAAUC,UAAV,IAAwB9C,KAAK,CAACmC,QAAN,CAAe,EAAf,CAA9B;AACA,QAAM,CAACY,WAAD,EAAcC,cAAd,IAAgChD,KAAK,CAACmC,QAAN,CAAe,KAAf,CAAtC;AACA,QAAM,CAACV,KAAD,EAAQwB,QAAR,IAAoBjD,KAAK,CAACmC,QAAN,CAAe;AAACV,IAAAA,KAAK,EAAC,IAAP;AAAaC,IAAAA,QAAQ,EAAC;AAAtB,GAAf,CAA1B;AACA,QAAM,CAACwB,EAAD,EAAKC,KAAL,IAAcnD,KAAK,CAACmC,QAAN,CAAe,KAAf,CAApB;AACA,QAAM,CAACiB,IAAD,EAAOC,OAAP,IAAkBrD,KAAK,CAACmC,QAAN,CAAe,KAAf,CAAxB;AACA,QAAM,CAACmB,IAAD,EAAOC,OAAP,IAAkBvD,KAAK,CAACmC,QAAN,CAAe,KAAf,CAAxB;;AACA,QAAMqB,SAAS,GAAG,MAAMtB,cAAc,CAAC,CAACD,WAAF,CAAtC;;AAEAjC,EAAAA,KAAK,CAACyD,SAAN,CAAgB,MAAK;AACjB,UAAMC,MAAM,GAAG9B,KAAK,CAACiB,OAAN,CAAcc,MAAd,CAAqBC,GAAG,IAAIA,GAAG,CAACC,UAAJ,KAAmBjC,KAAK,CAACgB,IAAN,CAAWkB,UAA1D,CAAf;AACAhB,IAAAA,UAAU,CAACY,MAAD,CAAV;AACH,GAHD,EAGE,CAAC9B,KAAD,CAHF,EAjBuB,CAuBvB;;AACA,QAAMmC,OAAO,GAAG,YAAW;AACvBR,IAAAA,OAAO,CAAC,IAAD,CAAP;AACA,UAAMS,WAAW,GAAGzB,IAAI,CAACjB,IAAzB;AACA,UAAM2C,WAAW,GAAGxB,QAApB;AACAwB,IAAAA,WAAW,CAACC,IAAZ,CAAiBF,WAAjB;AACA,UAAMG,KAAK,GAAGF,WAAW,CAACG,OAAZ,CAAoBJ,WAApB,CAAd;;AAEA,QAAGA,WAAW,KAAK,EAAhB,IAAsBzB,IAAI,CAAChB,KAAL,KAAe,EAArC,IAA2CgB,IAAI,CAACf,WAAL,KAAqB,EAAhE,IAAsEC,KAAK,CAACA,KAAN,KAAgB,IAAzF,EAA8F;AAC1FX,MAAAA,SAAS,CAAC,wBAAD,CAAT;AACAyC,MAAAA,OAAO,CAAC,KAAD,CAAP;AACA;AACH;;AAEA,UAAMc,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,IAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAuBP,WAAvB;AACAK,IAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAwBhC,IAAI,CAAChB,KAA7B;AACA8C,IAAAA,QAAQ,CAACE,MAAT,CAAgB,aAAhB,EAA+BhC,IAAI,CAACf,WAApC;AACA6C,IAAAA,QAAQ,CAACE,MAAT,CAAgB,YAAhB,EAA8B3C,KAAK,CAACgB,IAAN,CAAWkB,UAAzC;AACAO,IAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyBJ,KAAzB;AACAE,IAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB9C,KAAK,CAACA,KAA/B,EAnBsB,CAqBvB;;AAEA,UAAM+C,MAAM,GAAG,MAAMjE,UAAU,CAAC8D,QAAD,EAAY,mBAAZ,EAAgC;AAACI,MAAAA,aAAa,EAAC,YAAY1C;AAA3B,KAAhC,CAA/B;;AACA,QAAGyC,MAAM,CAACE,EAAV,EAAa;AACR9C,MAAAA,KAAK,CAAC+C,UAAN,CAAiBH,MAAM,CAACI,QAAP,CAAgBC,IAAjC;AACCrC,MAAAA,OAAO,CAACnB,YAAD,CAAP;AACA4B,MAAAA,QAAQ,CAAC;AAACxB,QAAAA,KAAK,EAAC,IAAP;AAAaC,QAAAA,QAAQ,EAAC;AAAtB,OAAD,CAAR;AACAd,MAAAA,WAAW,CAAC,iBAAD,CAAX;AACA2C,MAAAA,OAAO,CAAC,KAAD,CAAP;AACH,KANH,MAMO;AACD1C,MAAAA,UAAU,CAAC,gBAAD,CAAV;AACAgB,MAAAA,OAAO,CAACC,GAAR,CAAY0C,MAAM,CAACI,QAAnB;AACArB,MAAAA,OAAO,CAAC,KAAD,CAAP;AACH;;AAEHC,IAAAA,SAAS;AAEZ,GAtCD,CAxBuB,CA+DvB;;;AAEA,QAAMsB,aAAa,GAAIC,CAAD,IAAM;AACxBpC,IAAAA,OAAO,CAACoC,CAAC,CAACC,MAAF,CAASC,KAAV,CAAP;AACH,GAFD;;AAIA,QAAMC,YAAY,GAAG,YAAW;AAC7B;AAEC,UAAMC,SAAS,GAAGvD,KAAK,CAACgB,IAAN,CAAWkB,UAA7B;AACA,UAAMsB,QAAQ,GAAG9D,IAAjB;AACA,UAAM6C,KAAK,GAAGvC,KAAK,CAACgB,IAAN,CAAWuB,KAAzB;AAEA,UAAMkB,UAAU,GAAC;AACb/D,MAAAA,IAAI,EAAC8D,QADQ;AAEbtB,MAAAA,UAAU,EAAEqB,SAFC;AAGbhB,MAAAA,KAAK,EAACA;AAHO,KAAjB;AAKA,UAAMmB,MAAM,GAAG1D,KAAK,CAAC2D,QAAN,CAAeC,GAAf,CAAoBC,OAAD,IAAW;AACzC,aAAOA,OAAO,CAAC3B,UAAf;AACH,KAFc,CAAf;AAIA,UAAM4B,OAAO,GAAGJ,MAAM,CAAClB,OAAP,CAAexC,KAAK,CAACgB,IAAN,CAAWkB,UAA1B,CAAhB;AAEA,UAAMU,MAAM,GAAG,MAAMlE,SAAS,CAAC+E,UAAD,EAAc,qBAAoBF,SAAU,EAA5C,EAA+C;AAACV,MAAAA,aAAa,EAAE,YAAY1C;AAA5B,KAA/C,CAA9B;;AACA,QAAGyC,MAAM,CAACE,EAAV,EAAa;AACT7C,MAAAA,OAAO,CAACC,GAAR,CAAY0C,MAAM,CAACI,QAAP,CAAgBC,IAAhB,CAAqBA,IAAjC;AACAjD,MAAAA,KAAK,CAAC2D,QAAN,CAAeI,MAAf,CAAsBD,OAAtB,EAA+B,CAA/B,EAAkClB,MAAM,CAACI,QAAP,CAAgBC,IAAhB,CAAqBA,IAAvD;AACAjD,MAAAA,KAAK,CAACgE,aAAN;AACAhE,MAAAA,KAAK,CAACiE,WAAN,CAAkBjE,KAAK,CAAC2D,QAAxB;AACA3E,MAAAA,WAAW,CAAC,qBAAD,CAAX;AACH,KAND,MAMK;AACDC,MAAAA,UAAU,CAAC,gBAAD,CAAV;AACH;AAGJ,GA9BD;;AAgCA,QAAMiF,WAAW,GAAG,MAAM9C,cAAc,CAAC,CAACD,WAAF,CAAxC;;AAEA,QAAMgD,aAAa,GAAG,YAAW;AAC7B,UAAMC,SAAS,GAAGpE,KAAK,CAACgB,IAAN,CAAWkB,UAA7B;AACA,UAAMmC,SAAS,GAAGrE,KAAK,CAAC2D,QAAN,CAAeC,GAAf,CAAoBU,OAAD,IAAaA,OAAO,CAACpC,UAAxC,CAAlB;AACA,UAAMK,KAAK,GAAG8B,SAAS,CAAC7B,OAAV,CAAkB4B,SAAlB,CAAd;AACA,UAAMG,WAAW,GAAGvE,KAAK,CAAC2D,QAA1B,CAJ6B,CAK7B;;AACA,UAAMf,MAAM,GAAG,MAAMhE,YAAY,CAAE,qBAAoBwF,SAAU,EAAhC,CAAjC;;AACA,QAAGxB,MAAM,CAACE,EAAV,EAAa;AACTyB,MAAAA,WAAW,CAACR,MAAZ,CAAmBxB,KAAnB,EAA0B,CAA1B;AACAvC,MAAAA,KAAK,CAACgE,aAAN;AACAhE,MAAAA,KAAK,CAACwE,UAAN,CAAiBD,WAAjB;AACAvF,MAAAA,WAAW,CAAC,gCAAD,CAAX;AACH,KALD,MAKK;AACDC,MAAAA,UAAU,CAAC,gBAAD,CAAV;AACH;AAEJ,GAhBD;;AAkBA,QAAMwF,cAAc,GAAG,MAAMrD,cAAc,CAAC,KAAD,CAA3C;;AAEA,QAAMsD,UAAU,GAAG,YAAW;AAC1BnD,IAAAA,KAAK,CAAC,IAAD,CAAL;AACA,UAAM8C,SAAS,GAAGrE,KAAK,CAAC2D,QAAxB;AACA,UAAMgB,YAAY,GAAGN,SAAS,CAACT,GAAV,CAAcC,OAAO,IAAIA,OAAO,CAAC3B,UAAjC,CAArB;AACA,UAAMoC,OAAO,GAAGtE,KAAK,CAACgB,IAAN,CAAWkB,UAA3B;AACA,UAAMK,KAAK,GAAGoC,YAAY,CAACnC,OAAb,CAAqB8B,OAArB,CAAd;AAEA,UAAMM,OAAO,GAAGP,SAAS,CAAC9B,KAAK,GAAC,CAAP,CAAzB;AACA,UAAMsC,KAAK,GAAGR,SAAS,CAAC9B,KAAD,CAAvB;;AACA,QAAGA,KAAK,KAAK,CAAb,EAAe;AACX;AACA,YAAM,CAACuC,KAAD,IAAUT,SAAS,CAACN,MAAV,CAAiBxB,KAAjB,EAAwB,CAAxB,CAAhB;AACA8B,MAAAA,SAAS,CAAC/B,IAAV,CAAewC,KAAf;AAEA,YAAMC,WAAW,GAAG;AAChBC,QAAAA,OAAO,EAAChF,KAAK,CAACgB,IAAN,CAAWiE,OADH;AAEhBtB,QAAAA,QAAQ,EAAEU;AAFM,OAApB,CALW,CASX;AACA;;AACA,YAAMzB,MAAM,GAAG,MAAMjE,UAAU,CAACoG,WAAD,EAAc,wBAAd,EAAwC;AAACG,QAAAA,aAAa,EAAC,YAAY/E;AAA3B,OAAxC,CAA/B,CAXW,CAYX;;AACA,UAAGyC,MAAM,CAACE,EAAV,EAAa;AACb9C,QAAAA,KAAK,CAACgE,aAAN;AACAhE,QAAAA,KAAK,CAACiE,WAAN,CAAkBrB,MAAM,CAACI,QAAP,CAAgBC,IAAlC;AACA1B,QAAAA,KAAK,CAAC,KAAD,CAAL;AACC,OAJD,MAIK;AACDtC,QAAAA,UAAU,CAAC,gBAAD,CAAV;AACAsC,QAAAA,KAAK,CAAC,KAAD,CAAL;AACH;;AACD;AACH;;AAED8C,IAAAA,SAAS,CAACN,MAAV,CAAiBxB,KAAjB,EAAwB,CAAxB,EAA2BqC,OAA3B;AACAP,IAAAA,SAAS,CAAC9B,KAAK,GAAC,CAAP,CAAT,GAAqBsC,KAArB;AAEA,UAAME,WAAW,GAAG;AACZC,MAAAA,OAAO,EAAChF,KAAK,CAACgB,IAAN,CAAWiE,OADP;AAEZtB,MAAAA,QAAQ,EAAEU;AAFE,KAApB,CApC0B,CAyC1B;AACA;;AACA,UAAMzB,MAAM,GAAG,MAAMjE,UAAU,CAACoG,WAAD,EAAc,wBAAd,EAAwC;AAACG,MAAAA,aAAa,EAAC,YAAY/E;AAA3B,KAAxC,CAA/B,CA3C0B,CA4C1B;;AACA,QAAGyC,MAAM,CAACE,EAAV,EAAa;AACT9C,MAAAA,KAAK,CAACgE,aAAN;AACAhE,MAAAA,KAAK,CAACiE,WAAN,CAAkBrB,MAAM,CAACI,QAAP,CAAgBC,IAAlC;AACA1B,MAAAA,KAAK,CAAC,KAAD,CAAL;AACH,KAJD,MAIK;AAEDA,MAAAA,KAAK,CAAC,KAAD,CAAL;AACAtC,MAAAA,UAAU,CAAC,gBAAD,CAAV;AACH;AAEJ,GAvDD;;AA0DA,QAAMkG,YAAY,GAAG,YAAW;AAC5B1D,IAAAA,OAAO,CAAC,IAAD,CAAP;AACA,UAAM4C,SAAS,GAAGrE,KAAK,CAAC2D,QAAxB;AACA,UAAMgB,YAAY,GAAGN,SAAS,CAACT,GAAV,CAAcC,OAAO,IAAIA,OAAO,CAAC3B,UAAjC,CAArB;AACA,UAAMoC,OAAO,GAAGtE,KAAK,CAACgB,IAAN,CAAWkB,UAA3B;AACA,UAAMK,KAAK,GAAGoC,YAAY,CAACnC,OAAb,CAAqB8B,OAArB,CAAd;AAKA,UAAMc,SAAS,GAAGf,SAAS,CAAC9B,KAAK,GAAC,CAAP,CAA3B;AACA,UAAMsC,KAAK,GAAGR,SAAS,CAAC9B,KAAD,CAAvB;;AAEA,QAAG8B,SAAS,CAACgB,MAAV,GAAmB,CAAnB,KAAyB9C,KAA5B,EAAkC;AAC9B,YAAM,CAAC+C,IAAD,IAASjB,SAAS,CAACN,MAAV,CAAiBxB,KAAjB,EAAwB,CAAxB,CAAf;AACA8B,MAAAA,SAAS,CAACkB,OAAV,CAAkBD,IAAlB;AAEA,YAAMP,WAAW,GAAG;AAChBC,QAAAA,OAAO,EAAChF,KAAK,CAACgB,IAAN,CAAWiE,OADH;AAEhBtB,QAAAA,QAAQ,EAAEU;AAFM,OAApB;AAIA,YAAMzB,MAAM,GAAG,MAAMjE,UAAU,CAACoG,WAAD,EAAc,wBAAd,EAAwC;AAACG,QAAAA,aAAa,EAAC,YAAY/E;AAA3B,OAAxC,CAA/B;AACAF,MAAAA,OAAO,CAACC,GAAR,CAAY0C,MAAM,CAACI,QAAP,CAAgBC,IAA5B;;AACA,UAAGL,MAAM,CAACE,EAAV,EAAa;AACT9C,QAAAA,KAAK,CAACgE,aAAN;AACAhE,QAAAA,KAAK,CAACiE,WAAN,CAAkBrB,MAAM,CAACI,QAAP,CAAgBC,IAAlC;AACAxB,QAAAA,OAAO,CAAC,KAAD,CAAP;AACH,OAJD,MAIK;AACDxC,QAAAA,UAAU,CAAC,gBAAD,CAAV;AACAwC,QAAAA,OAAO,CAAC,KAAD,CAAP;AACH,OAjB6B,CAkB9B;;;AACA;AACH;;AAED4C,IAAAA,SAAS,CAACN,MAAV,CAAiBxB,KAAjB,EAAwB,CAAxB,EAA2B6C,SAA3B;AACAf,IAAAA,SAAS,CAAC9B,KAAK,GAAG,CAAT,CAAT,GAAuBsC,KAAvB;AAEA,UAAME,WAAW,GAAG;AAChBC,MAAAA,OAAO,EAAChF,KAAK,CAACgB,IAAN,CAAWiE,OADH;AAEhBtB,MAAAA,QAAQ,EAAEU;AAFM,KAApB;AAIA,UAAMzB,MAAM,GAAG,MAAMjE,UAAU,CAACoG,WAAD,EAAc,wBAAd,EAAwC;AAACG,MAAAA,aAAa,EAAC,YAAY/E;AAA3B,KAAxC,CAA/B;AACAF,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA8B0C,MAAM,CAACI,QAAP,CAAgBC,IAA9C;;AACA,QAAGL,MAAM,CAACE,EAAV,EAAa;AACT9C,MAAAA,KAAK,CAACgE,aAAN;AACAhE,MAAAA,KAAK,CAACiE,WAAN,CAAkBrB,MAAM,CAACI,QAAP,CAAgBC,IAAlC;AACAxB,MAAAA,OAAO,CAAC,KAAD,CAAP;AACH,KAJD,MAIK;AACDxC,MAAAA,UAAU,CAAC,gBAAD,CAAV;AACAwC,MAAAA,OAAO,CAAC,KAAD,CAAP;AACH,KAnD2B,CAqD5B;;AAEH,GAvDD;;AA0DA,sBAEI,oBAAC,gBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAIQ,oBAAC,KAAD;AAAO,IAAA,MAAM,EAAEpB,WAAf;AAA4B,IAAA,WAAW,EAAEuB,SAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,QAAD;AAAY,IAAA,IAAI,EAAEjB,IAAlB;AACY,IAAA,OAAO,EAAEC,OADrB;AAEY,IAAA,OAAO,EAAEuB,OAFrB;AAGY,IAAA,KAAK,EAAEtC,KAHnB;AAIY,IAAA,QAAQ,EAAEwB;AAJtB,KAKgBrB,KALhB;AAMY,IAAA,IAAI,EAAE0B,IANlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADJ,CAJR,eAgBQ,oBAAC,KAAD;AAAO,IAAA,MAAM,EAAElB,SAAf;AAA0B,IAAA,WAAW,EAAEE,OAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAI,IAAA,KAAK,EAAE;AAAK8E,MAAAA,KAAK,EAAC,iBAAX;AACKC,MAAAA,QAAQ,EAAC,QADd;AAEKC,MAAAA,UAAU,EAAC,MAFhB;AAGKC,MAAAA,SAAS,EAAC;AAHf,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADJ,CADJ,eASI,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCADJ,eAEI,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,QAAQ,EAAEzC,aAA7B;AAA4C,IAAA,KAAK,EAAExD,IAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,CATJ,eAaI,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,YAAD;AAAc,IAAA,OAAO,EAAGyD,CAAD,IAAK;AACxBA,MAAAA,CAAC,CAACyC,cAAF;AACAtC,MAAAA,YAAY;AACf,KAHD;AAGG,IAAA,QAAQ,EAAC,MAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CAbJ,CADJ,CAhBR,eAyCQ,oBAAC,KAAD;AAAO,IAAA,MAAM,EAAEnC,WAAf;AAA4B,IAAA,WAAW,EAAE+C,WAAzC;AAAsD,IAAA,cAAc,EAAEO,cAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+EAFJ,CADJ,eAMI,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEI;AAAS,IAAA,KAAK,EAAE;AAACoB,MAAAA,KAAK,EAAC,MAAP;AAAeC,MAAAA,QAAQ,EAAC,OAAxB;AAAiCC,MAAAA,MAAM,EAAC;AAAxC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA,oBAAC,YAAD;AAAgB,IAAA,OAAO,EAAE5B,aAAzB;AACgB,IAAA,QAAQ,EAAC,OADzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADA,eAIA,oBAAC,YAAD;AAAgB,IAAA,OAAO,EAAED,WAAzB;AACgB,IAAA,QAAQ,EAAC,OADzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJA,CADJ,CAFJ,CANJ,CAzCR,eAmEI;AAAS,IAAA,SAAS,EAAC,QAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEI;AAAK,IAAA,KAAK,EAAE;AAACsB,MAAAA,KAAK,EAAC;AAAP,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI;AAAG,IAAA,SAAS,EAAC,gBAAb;AAA8B,IAAA,KAAK,EAAE;AAACQ,MAAAA,WAAW,EAAC,KAAb;AAAoBR,MAAAA,KAAK,EAAC;AAA1B,KAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEK9F,IAFL,CAFJ,eAOI;AAAK,IAAA,KAAK,EAAE;AAACuG,MAAAA,OAAO,EAAC;AAAT,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEI,oBAAC,UAAD;AACY,IAAA,QAAQ,EAAC,MADrB;AAEY,IAAA,SAAS,EAAC,oBAFtB;AAGY,IAAA,OAAO,EAAEvF,OAHrB;AAIY,IAAA,KAAK,EAAC,iBAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMa;AAAG,IAAA,SAAS,EAAC,aAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANb,CAFJ,eAUI,oBAAC,UAAD;AACY,IAAA,QAAQ,EAAC,MADrB;AAEY,IAAA,SAAS,EAAC,oBAFtB;AAGY,IAAA,OAAO,EAAEwD,WAHrB;AAIY,IAAA,KAAK,EAAC,iBAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMa;AAAG,IAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANb,CAVJ,EAkBK5C,EAAE,gBACC,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,gBAGC,oBAAC,UAAD;AACY,IAAA,QAAQ,EAAC,MADrB;AAEY,IAAA,SAAS,EAAC,oBAFtB;AAGY,IAAA,OAAO,EAAEoD,UAHrB;AAIY,IAAA,KAAK,EAAC,iBAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMa;AAAG,IAAA,SAAS,EAAC,0BAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANb,CArBR,EA6BKlD,IAAI,gBACD,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADC,gBAGD,oBAAC,UAAD;AACY,IAAA,QAAQ,EAAC,MADrB;AAEY,IAAA,SAAS,EAAC,oBAFtB;AAGY,IAAA,OAAO,EAAE2D,YAHrB;AAIY,IAAA,KAAK,EAAC,iBAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAMa;AAAG,IAAA,SAAS,EAAC,4BAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANb,CAhCR,CAPJ,CAnEJ,eAsHI;AAAS,IAAA,SAAS,EAAC,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIKnF,KAAK,CAACiB,OAAN,CAAcoE,MAAd,KAAyB,CAAzB,GAA6B,IAA7B,gBAEG,0CAEQpE,OAAO,CAAC2C,GAAR,CAAY,CAAC5B,GAAD,EAAMkE,CAAN,KAAW;AACvB,wBAAO,oBAAC,IAAD;AAAS,MAAA,GAAG,EAAEA,CAAd;AACS,MAAA,GAAG,EAAElE,GADd;AAES,MAAA,IAAI,EAAErB,IAFf;AAGS,MAAA,OAAO,EAAEC,OAHlB;AAIS,MAAA,OAAO,EAAEuB,OAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AAMC,GAPD,CAFR,CANR,CAtHJ,eAmJI;AAAS,IAAA,SAAS,EAAC,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAEI,oBAAC,YAAD;AAAc,IAAA,OAAO,EAAEP,SAAvB;AAAkC,IAAA,IAAI,MAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAEI;AAAG,IAAA,SAAS,EAAC,oBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,CAFJ,CAnJJ,CAFJ;AA+JH,CA9YD,C,CAwZA;;;AAEA,MAAMuE,eAAe,GAAIC,KAAD,IAAW;AAC/B,SAAO;AACHhG,IAAAA,MAAM,EAAEgG,KAAK,CAACC,KADX;AAEH1C,IAAAA,QAAQ,EAAEyC,KAAK,CAACE,WAFb;AAGHrF,IAAAA,OAAO,EAAEmF,KAAK,CAACG;AAHZ,GAAP;AAKH,CAND;;AAOA,MAAMC,kBAAkB,GAAIC,QAAD,IAAc;AACrC,SAAO;AACHxC,IAAAA,WAAW,EAAGhB,IAAD,IAAU;AACnBwD,MAAAA,QAAQ,CAAC;AAACC,QAAAA,IAAI,EAAC,gBAAN;AAAwBzD,QAAAA,IAAI,EAACA;AAA7B,OAAD,CAAR;AACH,KAHE;AAKHe,IAAAA,aAAa,EAAE,MAAK;AAChByC,MAAAA,QAAQ,CAAC;AAACC,QAAAA,IAAI,EAAC;AAAN,OAAD,CAAR;AACH,KAPE;AAQH3D,IAAAA,UAAU,EAAGE,IAAD,IAAS;AACjBwD,MAAAA,QAAQ,CAAC;AACLC,QAAAA,IAAI,EAAC,YADA;AACczD,QAAAA,IAAI,EAACA;AADnB,OAAD,CAAR;AAGH,KAZE;AAaHuB,IAAAA,UAAU,EAAEvB,IAAD,IAAQ;AACfwD,MAAAA,QAAQ,CAAC;AAACC,QAAAA,IAAI,EAAC,gBAAN;AAAwBzD,QAAAA,IAAI,EAACA;AAA7B,OAAD,CAAR;AACH;AAfE,GAAP;AAiBH,CAlBD;;AAmBA,eAAepE,OAAO,CAACsH,eAAD,EAAkBK,kBAAlB,CAAP,CAA6CzG,OAA7C,CAAf","sourcesContent":["import React from 'react';\nimport { ContainerSection, TitleForm } from '../styles/menu-styles';\nimport Modal from '../../../../components/modales/modal';\nimport Item from './item';\nimport { ButtonAction } from '../../../../components/buttons/button-action';\nimport { PutMethod, PostMethod, DeleteMethod } from '../../../../utils/peticiones';\nimport {connect} from 'react-redux'\nimport FormItem from './forms/form-item';\nimport { ButtonIcon } from '../../../../components/buttons/button-icon';\nimport { SuccesAlert, ErrorAlert, InfoAlert } from '../../../../utils/alertas';\nimport { Input } from '../../../../components/inputs/inputs';\nimport { FieldInput, Label, Form } from '../../../../components/inputs/item-forms';\nimport { Split } from '../../../../components/containers/containers';\nimport BarCharge from '../../../../components/spiners/bar-charge';\n\nconst initialState={\n    name:'',\n    price:'',\n    description:'',\n    image:null,\n    imageUrl:''\n}\n\nconst Section = (props) => {\n    console.log('DEBUGGenado------------>', props);\n    const token = props.sesion.token\n    const [togglemodal, setTogglemodal] = React.useState(false);\n    const [togglePut, setToggleput] = React.useState(false)\n    const showPut = () => setToggleput(!togglePut)\n    const [item, setItem] = React.useState(initialState)\n    const [products, setProducts] = React.useState([])\n    const [name, setName]= React.useState(props.sect.name)\n    const [objects, setObjects] = React.useState([])\n    const [deletemodal, setDeleteModal] = React.useState(false)\n    const [image, setImage] = React.useState({image:null, imageUrl:''})\n    const [up, setUp] = React.useState(false)\n    const [down, setDown] = React.useState(false)\n    const [send, setSend] = React.useState(false)\n    const showModal = () => setTogglemodal(!togglemodal)\n    \n    React.useEffect(() =>{\n        const render = props.objects.filter(obj => obj.section_id === props.sect.id_section)\n        setObjects(render)\n    },[props])\n    \n\n    // AÑADIR ITEMS A LAS SECCIONES\n    const addItem = async () =>{\n        setSend(true)\n        const nameProduct = item.name\n        const newProducts = products\n        newProducts.push(nameProduct)\n        const index = newProducts.indexOf(nameProduct)\n\n        if(nameProduct === '' || item.price === '' || item.description === '' || image.image === null){\n            InfoAlert('Llena todos los campos')\n            setSend(false)\n            return;\n        }\n\n         const formData = new FormData();\n         formData.append('name',nameProduct)\n         formData.append('price',item.price)\n         formData.append('description', item.description)\n         formData.append('id_section', props.sect.id_section)\n         formData.append('index', index)\n         formData.append('image', image.image)\n        \n        //console.log('ESTO SE ENVIA', image)\n\n        const result = await PostMethod(formData, `api/users/product`, {Authoritazion:'Bearer ' + token})\n        if(result.ok){\n             props.addProduct(result.response.data)\n              setItem(initialState)\n              setImage({image:null, imageUrl:''})\n              SuccesAlert('Producto creado');\n              setSend(false)\n          }else{\n              ErrorAlert('Algo salio mal')\n              console.log(result.response)\n              setSend(false)\n          }\n        \n        showModal();\n        \n    }\n    // AÑADIR ITEMS A LAS SECCIONES\n\n    const handleSection = (e) =>{\n        setName(e.target.value);\n    }\n\n    const handleSubmit = async () =>{\n       // const menuId  = props.sect.menu_id\n       \n        const sectionId = props.sect.id_section\n        const menuName = name\n        const index = props.sect.index\n\n        const putSection={\n            name:menuName,\n            id_section: sectionId,\n            index:index\n        }\n        const mapear = props.sections.map((section)=>{\n            return section.id_section\n        })\n\n        const element = mapear.indexOf(props.sect.id_section)\n        \n        const result = await PutMethod(putSection, `api/users/section/${sectionId}`, {Authoritazion: 'Bearer ' + token})\n        if(result.ok){\n            console.log(result.response.data.data)\n            props.sections.splice(element, 1, result.response.data.data);\n            props.cleanSections();\n            props.editSection(props.sections)\n            SuccesAlert('Seccion Actualizada')\n        }else{\n            ErrorAlert('Algo salio mal')\n        }\n\n\n    }\n\n    const deleteModal = () => setDeleteModal(!deletemodal)\n\n    const deleteSection = async () =>{\n        const idSection = props.sect.id_section\n        const secciones = props.sections.map((seccion) => seccion.id_section)\n        const index = secciones.indexOf(idSection);\n        const arrSections = props.sections\n        //console.log('%c->RESULTADO-RESULTADO', 'color:peru', arrSections)\n        const result = await DeleteMethod(`api/users/section/${idSection}`)\n        if(result.ok){\n            arrSections.splice(index, 1)\n            props.cleanSections()\n            props.dltSection(arrSections)\n            SuccesAlert('Esta sección ha sido eliminada');\n        }else{\n            ErrorAlert('Algo salio mal');\n        }\n      \n    }\n\n    const cerrarFunction = () => setDeleteModal(false)\n\n    const upPosition = async () =>{\n        setUp(true)\n        const secciones = props.sections\n        const mapSecciones = secciones.map(section => section.id_section)\n        const seccion = props.sect.id_section\n        const index = mapSecciones.indexOf(seccion)\n\n        const upMover = secciones[index-1]\n        const mover = secciones[index]\n        if(index === 0){\n            //console.log('Primer elemento')\n            const [first] = secciones.splice(index, 1);\n            secciones.push(first)\n\n            const newSections = {\n                id_menu:props.sect.menu_id,\n                sections: secciones\n            }\n            //TO DO:PETICION\n            //console.log('%c->PRMER ELEMENTO', 'color:tomato', newSections)\n            const result = await PostMethod(newSections, 'api/users/section/sort', {Authorization:'Bearer ' + token})\n            //console.log('RESPUESTA TIGRE',result.response.data)\n            if(result.ok){\n            props.cleanSections()\n            props.editSection(result.response.data)\n            setUp(false)\n            }else{\n                ErrorAlert('Algo salio mal')\n                setUp(false)\n            }\n            return;\n        }\n        \n        secciones.splice(index, 1, upMover)\n        secciones[index-1] = mover\n\n        const newSections = {\n                id_menu:props.sect.menu_id,\n                sections: secciones\n        }\n\n        //TO DO: peticion\n        //console.log('%c->ELEMENTO DE ARRIBA', 'color:tomato', newSections)\n        const result = await PostMethod(newSections, 'api/users/section/sort', {Authorization:'Bearer ' + token})\n        //console.log('RESPUESTA TIGRE',result.response.data)\n        if(result.ok){\n            props.cleanSections()\n            props.editSection(result.response.data)\n            setUp(false)\n        }else{\n            \n            setUp(false)\n            ErrorAlert('Algo salio mal')\n        }\n        \n    }\n\n\n    const downPosition = async () =>{\n        setDown(true)\n        const secciones = props.sections\n        const mapSecciones = secciones.map(section => section.id_section)\n        const seccion = props.sect.id_section\n        const index = mapSecciones.indexOf(seccion)\n\n        \n\n\n        const downMover = secciones[index+1]\n        const mover = secciones[index]\n\n        if(secciones.length - 1 === index){\n            const [last] = secciones.splice(index, 1)\n            secciones.unshift(last)\n\n            const newSections = {\n                id_menu:props.sect.menu_id,\n                sections: secciones\n            }\n            const result = await PostMethod(newSections, 'api/users/section/sort', {Authorization:'Bearer ' + token})\n            console.log(result.response.data)\n            if(result.ok){\n                props.cleanSections()\n                props.editSection(result.response.data)\n                setDown(false)\n            }else{\n                ErrorAlert('Algo salio mal')\n                setDown(false)\n            }\n            //console.log('%c->DOWN', 'color:tomato', newSections)\n            return;\n        }\n        \n        secciones.splice(index, 1, downMover)\n        secciones[index + 1] = mover\n\n        const newSections = {\n            id_menu:props.sect.menu_id,\n            sections: secciones\n        }\n        const result = await PostMethod(newSections, 'api/users/section/sort', {Authorization:'Bearer ' + token})\n        console.log('RESPUESTA TIGRE',result.response.data)\n        if(result.ok){\n            props.cleanSections()\n            props.editSection(result.response.data)\n            setDown(false)\n        }else{\n            ErrorAlert('Algo salio mal')\n            setDown(false)\n        }\n\n        //console.log('%c->DOWN', 'color:tomato', newSections)\n\n    }\n   \n\n    return (\n        \n        <ContainerSection>\n\n\n            {/* MODAL PARA CREARSECCION */}\n                <Modal toggle={togglemodal} toggleModal={showModal}>\n                    <FormItem   item={item}\n                                setItem={setItem}\n                                addItem={addItem}\n                                image={image}\n                                setImage={setImage}\n                                {...props}\n                                send={send}\n                                />\n                </Modal>\n            {/* MODAL PARA CREARSECCION */}\n            {/* MODAL DE EDITAR */}\n                <Modal toggle={togglePut} toggleModal={showPut}>\n                    <Form>\n                        <FieldInput>\n                            <h1 style={{    color:'var(--colordos)',\n                                            fontSize:'1.5rem',\n                                            fontFamily:'Bold',\n                                            textAlign:'center'\n                                            }}>Editar sección</h1>\n          \n                        </FieldInput>\n                        <FieldInput>\n                            <Label>Editar nombre de sección</Label>\n                            <Input name=\"name\" onChange={handleSection} value={name}/>\n                        </FieldInput>\n                        <FieldInput>\n                            <ButtonAction onClick={(e)=>{\n                                e.preventDefault();\n                                handleSubmit()\n                            }} maxWidth=\"100%\">Editar</ButtonAction>\n                        </FieldInput>\n                    </Form>\n                </Modal>\n            {/* MODAL DE EDITAR */}\n\n            {/* MODAL DE BORRAR */} \n                <Modal toggle={deletemodal} toggleModal={deleteModal} cerrarFunction={cerrarFunction}>\n                    <TitleForm>\n                        <h1>¿Desas borrar esta sección?</h1>\n                        <p>Al eliminar esta seccion se eliminarán todos los items que contenga.</p>\n                    </TitleForm>\n                  \n                    <FieldInput>\n                        \n                        <section style={{width:'100%', maxWidth:'220px', margin:'auto'}}>\n                            <Split>\n                            <ButtonAction   onClick={deleteSection}\n                                            maxWidth=\"100px\"\n                            >Si</ButtonAction>\n                            <ButtonAction   onClick={deleteModal}\n                                            maxWidth=\"100px\"\n                            >Cancelar</ButtonAction>\n                            </Split>\n                        </section>\n                        \n                    </FieldInput>\n                    \n                </Modal>\n            {/* MODAL DE BORRAR */}\n\n\n\n            <section className=\"header\">\n            \n                <div style={{color:'var(--colordos)'}}>\n                    <i className=\"fas fa-columns\" style={{marginRight:'5px', color:'var(--colordos)'}}></i>\n                    {name}\n                </div>\n                \n                <div style={{display:'flex'}}>\n                    \n                    <ButtonIcon  \n                                fontSize=\"1rem\"\n                                backColor='var(--colorcuatro)'\n                                onClick={showPut}\n                                color='var(--colordos)'\n                                \n                                ><i className=\"fas fa-edit\"></i></ButtonIcon>\n                    \n                    <ButtonIcon  \n                                fontSize=\"1rem\"\n                                backColor='var(--colorcuatro)'\n                                onClick={deleteModal}\n                                color='var(--colordos)'\n                                \n                                ><i className=\"fas fa-trash-alt\"></i></ButtonIcon>\n        {/* REORDENAR ------------>*/}\n                    {up ?\n                        <BarCharge/>\n                        :\n                        <ButtonIcon  \n                                    fontSize=\"1rem\"\n                                    backColor='var(--colorcuatro)'\n                                    onClick={upPosition}\n                                    color='var(--colordos)'\n                                    \n                                    ><i className=\"fas fa-chevron-circle-up\"></i></ButtonIcon>\n                    }\n                    {down ?\n                        <BarCharge/>\n                        :\n                        <ButtonIcon  \n                                    fontSize=\"1rem\"\n                                    backColor='var(--colorcuatro)'\n                                    onClick={downPosition}\n                                    color='var(--colordos)'\n                                    \n                                    ><i className=\"fas fa-chevron-circle-down\"></i></ButtonIcon>\n                    }\n                                \n                </div>\n            </section>\n\n            <section className=\"body\">\n                {/* AQUI SE RENDERIZAN LOS ITEMS */}\n\n\n                {props.objects.length === 0 ? null : \n\n                    <>\n                        {\n                            objects.map((obj, i) =>{\n                            return <Item    key={i}\n                                            obj={obj}\n                                            item={item}\n                                            setItem={setItem}\n                                            addItem={addItem}\n                                            />\n                            })\n                        }\n                        \n                    </>\n                }\n\n\n\n\n                {/* AQUI SE RENDERIZAN LOS ITEMS */}\n            </section>\n\n\n\n            <section className=\"btn-add\">\n                \n                <ButtonAction onClick={showModal} icon>\n                    Añadir productos\n                    <i className=\"fas fa-plus-circle\"></i>\n                </ButtonAction>\n            </section>\n        </ContainerSection>\n        \n    );\n};\n\n\n\n\n\n\n\n\n\n//REDUX---------->\n\nconst mapStateToProps = (state) => {\n    return {\n        sesion: state.login,\n        sections: state.menuSection,\n        objects: state.menuObject\n    }\n}\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        editSection: (data) => {\n            dispatch({type:'EDITAR_SECTION', data:data})\n        },\n\n        cleanSections: () =>{\n            dispatch({type:'CLEAN_SECTIONS'})\n        },\n        addProduct: (data) =>{\n            dispatch({\n                type:'ADD_OBJECT', data:data\n            })\n        },\n        dltSection:(data)=>{\n            dispatch({type:'EDITAR_SECTION', data:data})\n        }\n    }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(Section)\n"]},"metadata":{},"sourceType":"module"}