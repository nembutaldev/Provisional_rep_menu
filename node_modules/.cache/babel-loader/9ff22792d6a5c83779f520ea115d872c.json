{"ast":null,"code":"var _jsxFileName = \"/Users/Buffalo/Desktop/menu/copia/Provisional_rep_menu/src/pages/auth/menu-editar/forms/create-product.jsx\";\nimport React from 'react';\nimport Modal from '../../../../components/modales/modal';\nimport { Form, FieldInput, Label } from '../../../../components/inputs/item-forms';\nimport { Input, TextArea } from '../../../../components/inputs/inputs';\nimport InputFile from '../../../../components/inputs/input_file/input_file';\nimport uuid from 'react-uuid';\nimport { connect } from 'react-redux';\nimport { PostMethod } from '../../../../utils/peticiones';\nimport { ButtonAction } from '../../../../components/buttons/button-action';\nimport { ErrorAlert, SuccesAlert, InfoAlert } from '../../../../utils/alertas';\nimport SpinerForm from '../../../../components/spiners/spiner-form';\n\nconst CreateProduct = props => {\n  console.log('CREAR', props);\n  const token = props.sesion;\n  const [modal, setModal] = React.useState(false);\n  const [send, setSend] = React.useState(false);\n  const [producto, setProducto] = React.useState({\n    image: null,\n    urlImage: '',\n    name: '',\n    price: '',\n    description: ''\n  });\n  React.useEffect(() => {\n    setTimeout(() => {\n      setModal(true);\n    }, 100);\n\n    if (props.match.params.product) {\n      const idProduct = parseInt(props.match.params.product);\n      const productos = props.products;\n\n      if (productos.length !== 0) {\n        const mapProductos = productos.map(producto => producto.id_product);\n        const indexSelect = mapProductos.indexOf(idProduct);\n        const obj = productos[indexSelect];\n        console.log(obj);\n        setProducto({ ...producto,\n          urlImage: obj.url_image,\n          name: obj.name,\n          price: obj.price,\n          description: obj.description\n        });\n      }\n    } else {\n      console.log('no existe el producto');\n    }\n  }, [props]);\n\n  const openClose = () => {\n    setModal(!modal);\n    props.history.push(`/dashboard/menu/${props.match.params.menu}`);\n  };\n\n  const closeModal = () => {\n    setModal(false);\n    props.history.push(`/dashboard/menu/${props.match.params.menu}`);\n  };\n\n  const onDrop = e => {\n    e.preventDefault();\n    const file = e.dataTransfer.files[0];\n    let reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = function () {\n      setProducto({ ...producto,\n        image: file,\n        urlImage: reader.result\n      });\n    };\n  };\n\n  const onDragOver = e => {\n    e.preventDefault();\n  };\n\n  const handleFile = e => {\n    if (e.target.files && e.target.files[0]) {\n      const file = e.target.files[0];\n      let reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = function () {\n        setProducto({ ...producto,\n          image: file,\n          urlImage: reader.result\n        });\n      };\n    }\n  };\n\n  const handleChange = e => {\n    setProducto({ ...producto,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setSend(true);\n    const productos = props.products;\n    const filterProducts = productos.filter(pr => pr.section_id === parseInt(props.match.params.section));\n    const index = filterProducts.length;\n\n    if (props.match.params.product) {\n      const mapProducts = productos.map(producto => producto.id_product);\n      const ideSelected = parseInt(props.match.params.product);\n      const indexSelected = mapProducts.indexOf(ideSelected);\n\n      if (producto.name === '' || producto.description === '' || producto.price === '') {\n        InfoAlert('LLena todos los campos');\n        setSend(false);\n        return;\n      }\n\n      const formData = new FormData();\n      formData.append('name', producto.name);\n      formData.append('price', producto.price);\n      formData.append('description', producto.description);\n      formData.append('id_section', props.match.params.section);\n      formData.append('index', index);\n      formData.append('_method', 'PUT');\n      formData.append('image', producto.image);\n      const result = await PostMethod(formData, `api/users/product/${props.match.params.product}`, {\n        Authorization: 'Bearer ' + token\n      });\n\n      if (result.ok) {\n        //console.log(result.response.data)\n        productos.splice(indexSelected, 1, result.response.data);\n        props.cleanProduct();\n        props.refreshProduct(productos);\n        SuccesAlert('Producto actualizado');\n        setSend(false);\n        props.history.push(`/dashboard/menu/${props.match.params.menu}`);\n      } else {\n        ErrorAlert('Algo salio mal');\n        setSend(false);\n        props.history.push(`/dashboard/menu/${props.match.params.menu}`);\n      }\n\n      return;\n    }\n\n    if (producto.image === null || producto.name === '' || producto.description === '' || producto.price === '') {\n      InfoAlert('LLena todos los campos');\n      setSend(false);\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append('name', producto.name);\n    formData.append('price', producto.price);\n    formData.append('description', producto.description);\n    formData.append('id_section', props.match.params.section);\n    formData.append('index', index);\n    formData.append('image', producto.image);\n    const result = await PostMethod(formData, `api/users/product`, {\n      Authoritazion: 'Bearer ' + token\n    });\n\n    if (result.ok) {\n      console.log(result.response.data);\n      props.addProduct(result.response.data);\n      SuccesAlert('Producto creado');\n      setSend(false);\n      props.history.push(`/dashboard/menu/${props.match.params.menu}`);\n    } else {\n      ErrorAlert('Algo salio mal');\n      setSend(false);\n      props.history.push(`/dashboard/menu/${props.match.params.menu}`);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Modal, {\n    toggle: modal,\n    toggleModal: openClose,\n    cerrarFunction: closeModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    style: {\n      color: 'var(--colordos)',\n      fontSize: '1.5rem',\n      fontFamily: 'Bold',\n      textAlign: 'center'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }, \"Crear producto\")), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 25\n    }\n  }, \"Sube o arrastra una imagen\"), /*#__PURE__*/React.createElement(InputFile, {\n    ide: `p-image${uuid()}`,\n    onDrop: onDrop,\n    onDragOver: onDragOver,\n    imgPrevio: producto.urlImage,\n    onChange: handleFile,\n    width: \"100%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 25\n    }\n  }, \"Nombre del producto:\"), /*#__PURE__*/React.createElement(Input, {\n    type: \"text\",\n    name: \"name\",\n    value: producto.name,\n    placeholder: \"Asigna un nombre\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 25\n    }\n  }, \"Precio:\"), /*#__PURE__*/React.createElement(Input, {\n    type: \"number\",\n    name: \"price\",\n    value: producto.price,\n    placeholder: \"Asigna un precio\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 25\n    }\n  }, \"Descripci\\xF3n\"), /*#__PURE__*/React.createElement(TextArea, {\n    name: \"description\",\n    value: producto.description,\n    placeholder: \"Descripcion\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 25\n    }\n  })), /*#__PURE__*/React.createElement(FieldInput, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 21\n    }\n  }, send ? /*#__PURE__*/React.createElement(SpinerForm, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 29\n    }\n  }) : /*#__PURE__*/React.createElement(ButtonAction, {\n    maxWidth: \"100%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 29\n    }\n  }, \" Agregar item\")))));\n}; //------>REDUX\n\n\nconst mapStateToProps = state => {\n  return {\n    products: state.menuProduct,\n    sesion: state.login\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    addProduct: data => {\n      dispatch({\n        type: 'ADD_PRODUCT',\n        data: data\n      });\n    },\n    refreshProduct: data => {\n      dispatch({\n        type: 'EDITAR_PRODUCT',\n        data: data\n      });\n    },\n    cleanProduct: () => {\n      dispatch({\n        type: 'CLEAN_PRODUCT'\n      });\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateProduct);","map":{"version":3,"sources":["/Users/Buffalo/Desktop/menu/copia/Provisional_rep_menu/src/pages/auth/menu-editar/forms/create-product.jsx"],"names":["React","Modal","Form","FieldInput","Label","Input","TextArea","InputFile","uuid","connect","PostMethod","ButtonAction","ErrorAlert","SuccesAlert","InfoAlert","SpinerForm","CreateProduct","props","console","log","token","sesion","modal","setModal","useState","send","setSend","producto","setProducto","image","urlImage","name","price","description","useEffect","setTimeout","match","params","product","idProduct","parseInt","productos","products","length","mapProductos","map","id_product","indexSelect","indexOf","obj","url_image","openClose","history","push","menu","closeModal","onDrop","e","preventDefault","file","dataTransfer","files","reader","FileReader","readAsDataURL","onload","result","onDragOver","handleFile","target","handleChange","value","handleSubmit","filterProducts","filter","pr","section_id","section","index","mapProducts","ideSelected","indexSelected","formData","FormData","append","Authorization","ok","splice","response","data","cleanProduct","refreshProduct","Authoritazion","addProduct","color","fontSize","fontFamily","textAlign","mapStateToProps","state","menuProduct","login","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Modal from '../../../../components/modales/modal';\nimport { Form, FieldInput, Label } from '../../../../components/inputs/item-forms';\nimport { Input, TextArea } from '../../../../components/inputs/inputs';\nimport InputFile from '../../../../components/inputs/input_file/input_file';\nimport uuid from 'react-uuid'\nimport {connect} from 'react-redux'\nimport { PostMethod } from '../../../../utils/peticiones';\nimport { ButtonAction } from '../../../../components/buttons/button-action';\nimport { ErrorAlert, SuccesAlert, InfoAlert } from '../../../../utils/alertas';\nimport SpinerForm from '../../../../components/spiners/spiner-form';\n\n\n\nconst CreateProduct = (props) => {\n    console.log('CREAR',props)\n\n    const token = props.sesion\n    const [modal, setModal] = React.useState(false)\n    const [send, setSend] = React.useState(false)\n    const [producto, setProducto] = React.useState({    image:null, urlImage:'',name:'',\n                                                        price:'', description:''\n                                                    })\n\n    React.useEffect(()=>{\n\n        setTimeout(()=>{setModal(true)},100)\n\n        if(props.match.params.product){\n\n            const idProduct = parseInt(props.match.params.product)\n            const productos = props.products\n\n            if(productos.length !== 0){\n                const mapProductos = productos.map((producto) => producto.id_product)\n                const indexSelect = mapProductos.indexOf(idProduct)\n                const obj = productos[indexSelect]\n                console.log(obj)\n                setProducto({\n                    ...producto,\n                    urlImage:obj.url_image,\n                    name:obj.name,\n                    price:obj.price,\n                    description:obj.description\n                })\n            }\n\n        }else{\n            console.log('no existe el producto')\n        }\n    },[props])\n\n    const openClose = () =>{\n        setModal(!modal)\n        props.history.push(`/dashboard/menu/${props.match.params.menu}`)\n    }\n    \n    const closeModal = () =>{\n        setModal(false)\n        props.history.push(`/dashboard/menu/${props.match.params.menu}`)\n    }\n    \n    const onDrop = (e)=>{\n        e.preventDefault();\n        const file = e.dataTransfer.files[0]\n\n        let reader = new FileReader();\n        reader.readAsDataURL(file)\n        reader.onload = function(){\n            setProducto({\n                ...producto,\n                image: file,\n                urlImage: reader.result\n            })\n        }\n    }\n\n    const onDragOver = (e) =>{e.preventDefault()}\n\n    const handleFile = (e) =>{\n        if(e.target.files && e.target.files[0]){\n            const file = e.target.files[0]\n\n            let reader = new FileReader();\n            reader.readAsDataURL(file)\n            reader.onload = function(){\n                setProducto({\n                    ...producto,\n                    image: file,\n                    urlImage: reader.result\n                })\n            }\n        }\n    }\n\n    const handleChange = (e) =>{\n        setProducto({\n            ...producto,\n            [e.target.name] : e.target.value\n        })\n    }\n\n    const handleSubmit = async (e) =>{\n        e.preventDefault();\n        setSend(true)\n        \n        const productos = props.products\n        const filterProducts = productos.filter((pr) => pr.section_id === parseInt(props.match.params.section))\n        const index = filterProducts.length\n\n        if(props.match.params.product){\n\n            const mapProducts = productos.map((producto) => producto.id_product)\n            const ideSelected = parseInt(props.match.params.product)\n            const indexSelected = mapProducts.indexOf(ideSelected)\n            \n            if( producto.name === '' || producto.description === '' || producto.price === ''){\n                InfoAlert('LLena todos los campos')\n                setSend(false)\n                return;\n            }\n            \n            const formData = new FormData();\n            formData.append('name', producto.name)\n            formData.append('price', producto.price)\n            formData.append('description', producto.description)\n            formData.append('id_section', props.match.params.section)\n            formData.append('index', index)\n            formData.append('_method', 'PUT')\n            formData.append('image', producto.image)\n            const result = await PostMethod(formData, `api/users/product/${props.match.params.product}`, {Authorization:'Bearer ' + token})\n            if(result.ok){\n                //console.log(result.response.data)\n                productos.splice(indexSelected, 1 , result.response.data)\n                props.cleanProduct();\n                props.refreshProduct(productos)\n                SuccesAlert('Producto actualizado')\n                setSend(false)\n                props.history.push(`/dashboard/menu/${props.match.params.menu}`)\n            }else{\n                ErrorAlert('Algo salio mal')\n                setSend(false)\n                props.history.push(`/dashboard/menu/${props.match.params.menu}`)\n            }\n            \n            return;\n        }\n        if(producto.image === null || producto.name === '' || producto.description === '' || producto.price === ''){\n            InfoAlert('LLena todos los campos')\n            setSend(false)\n            return;\n        }\n\n        const formData = new FormData();\n        formData.append('name', producto.name)\n        formData.append('price', producto.price)\n        formData.append('description', producto.description)\n        formData.append('id_section', props.match.params.section)\n        formData.append('index', index)\n        formData.append('image', producto.image)\n\n        \n\n        const result = await PostMethod(formData, `api/users/product`, {Authoritazion:'Bearer ' +  token})\n        if(result.ok){\n            console.log(result.response.data)\n            props.addProduct(result.response.data)\n            SuccesAlert('Producto creado')\n            setSend(false)\n            props.history.push(`/dashboard/menu/${props.match.params.menu}`)\n        }else{\n            ErrorAlert('Algo salio mal')\n            setSend(false)\n            props.history.push(`/dashboard/menu/${props.match.params.menu}`)\n        }\n    }\n\n\n\n    return (\n        <>\n            <Modal toggle={modal} toggleModal={openClose} cerrarFunction={closeModal}>\n                <Form onSubmit={handleSubmit}>\n\n\n                    <FieldInput>\n                        <h1 style={{    color:'var(--colordos)',\n                                        fontSize:'1.5rem',\n                                        fontFamily:'Bold',\n                                        textAlign:'center'\n                                        }}>Crear producto</h1>\n                    </FieldInput>\n\n                    <FieldInput>\n                        <Label>Sube o arrastra una imagen</Label>\n                        \n                       \n                        <InputFile  ide={`p-image${uuid()}`}\n                                    onDrop={onDrop}\n                                    onDragOver={onDragOver}\n                                    imgPrevio={producto.urlImage}\n                                    onChange={handleFile}\n                                    width=\"100%\"\n                                    />\n                      \n                        \n\n                    </FieldInput>\n\n\n\n\n\n\n                    <FieldInput>\n                        <Label>Nombre del producto:</Label>\n                        <Input  type=\"text\"\n                                name=\"name\"\n                                value={producto.name}\n                                placeholder=\"Asigna un nombre\"\n                                onChange={handleChange}/>\n                    </FieldInput>\n\n                    <FieldInput>\n                        <Label>Precio:</Label>\n                        <Input  type=\"number\"\n                                name=\"price\"\n                                value={producto.price}\n                                placeholder=\"Asigna un precio\"\n                                onChange={handleChange}/>\n                    </FieldInput>\n\n                    <FieldInput>\n                        <Label>Descripción</Label>\n                        <TextArea\n                            name=\"description\"\n                            value={producto.description}\n                            placeholder=\"Descripcion\"\n                            onChange={handleChange}\n                        ></TextArea>\n                    </FieldInput>\n\n                    <FieldInput>\n                        {send ?\n                            <SpinerForm/>\n                            :\n                            <ButtonAction maxWidth=\"100%\"> Agregar item</ButtonAction>\n                        }\n                    </FieldInput>\n\n                </Form>\n            </Modal>\n        </>\n    );\n};\n\n//------>REDUX\n\nconst mapStateToProps = (state) => {\n    return {\n        products: state.menuProduct,\n        sesion : state.login\n    }\n}\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        addProduct: (data) => {\n            dispatch({type:'ADD_PRODUCT', data:data})\n        },\n        refreshProduct: (data) => {\n            dispatch({type:'EDITAR_PRODUCT', data:data})\n        },\n        cleanProduct: () => {\n            dispatch({type:'CLEAN_PRODUCT'})\n        },\n    }\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateProduct)"]},"metadata":{},"sourceType":"module"}